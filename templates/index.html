<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Quantum X Terminal</title>

<style>
body{
    margin:0;
    font-family:'Segoe UI',sans-serif;
    background: linear-gradient(135deg,#0f172a,#020617);
    color:white;
}

header{
    padding:20px;
    text-align:center;
    font-size:26px;
    font-weight:600;
    background:linear-gradient(90deg,#06b6d4,#7c3aed);
    -webkit-background-clip:text;
    -webkit-text-fill-color:transparent;
}

.section{padding:15px 20px;}

button{
    padding:8px 14px;
    border-radius:10px;
    border:none;
    margin:4px;
    font-size:13px;
    cursor:pointer;
    background:linear-gradient(45deg,#06b6d4,#3b82f6);
    color:white;
    transition:0.3s;
}
button:hover{
    transform:scale(1.05);
    box-shadow:0 0 15px #3b82f6;
}

select,input{
    padding:8px;
    border-radius:10px;
    border:none;
    margin:4px;
    background:rgba(255,255,255,0.08);
    color:white;
}

.grid{
    display:grid;
    grid-template-columns:repeat(auto-fit,minmax(180px,1fr));
    gap:15px;
    padding:20px;
}

.card{
    background:rgba(255,255,255,0.06);
    backdrop-filter:blur(12px);
    border-radius:15px;
    padding:15px;
    border:1px solid rgba(255,255,255,0.1);
    text-align:center;
}

.asset-box{
    padding:12px;
    border-radius:10px;
    background:rgba(255,255,255,0.05);
    cursor:pointer;
    text-align:center;
}
.asset-box:hover{
    background:#1e293b;
}
.asset-selected{
    border:2px solid #06b6d4;
    box-shadow:0 0 12px #06b6d4;
}

.heat-bull{background:#065f46;}
.heat-bear{background:#7f1d1d;}
.heat-neutral{background:#78350f;}

</style>
</head>
<body>

<header>Quantum X Institutional Terminal</header>

<div class="section">

<!-- MARKET -->
<button onclick="setMarket('crypto')">Crypto</button>
<button onclick="setMarket('forex')">Forex</button>
<button onclick="setMarket('all')">Whole Market</button>
<button onclick="showSingle()">Single Asset</button>

<br><br>

<!-- STYLE -->
<button onclick="setStyle('scalp')">Scalp</button>
<button onclick="setStyle('intraday')">Intraday</button>
<button onclick="setStyle('swing')">Swing</button>

<select id="durationUnit">
<option value="seconds">Seconds</option>
<option value="minutes">Minutes</option>
<option value="hours">Hours</option>
<option value="days">Days</option>
</select>

<input type="number" id="durationValue" placeholder="Duration">

<br><br>

<input type="number" id="account" placeholder="Account Balance">
<input type="number" id="risk" step="0.1" placeholder="Risk %">

<br><br>

<button onclick="generate()">Generate Trades</button>
<button onclick="loadHeatmap()">Heatmap</button>
<button onclick="loadAnalytics()">Dashboard</button>

</div>

<div id="assetGrid" class="grid"></div>
<div id="output" class="grid"></div>
<div id="dashboard" class="section"></div>

<script>

let currentMarket="crypto";
let selectedAsset=null;

const cryptoAssets=[
"BTCUSDT","ETHUSDT","BNBUSDT","XRPUSDT","ADAUSDT",
"SOLUSDT","DOGEUSDT","MATICUSDT","DOTUSDT","AVAXUSDT",
"LTCUSDT","TRXUSDT","LINKUSDT","ATOMUSDT","XLMUSDT",
"NEARUSDT","FILUSDT","AAVEUSDT","SANDUSDT","HBARUSDT",
"FTMUSDT","OPUSDT","APTUSDT","INJUSDT","ARBUSDT"
];

const forexAssets=[
"EURUSD","GBPUSD","USDJPY","AUDUSD","USDCAD",
"USDCHF","NZDUSD","EURGBP","EURJPY","GBPJPY",
"AUDJPY","CHFJPY","EURAUD","GBPAUD","CADJPY"
];

function setMarket(m){
    currentMarket=m;
    document.getElementById("assetGrid").innerHTML="";
}

function showSingle(){
    const container=document.getElementById("assetGrid");
    container.innerHTML="";
    const list=currentMarket==="forex"?forexAssets:cryptoAssets;

    list.forEach(a=>{
        container.innerHTML+=`
        <div class="asset-box" onclick="selectAsset('${a}')">
        ${a}
        </div>`;
    });
}

function selectAsset(asset){
    selectedAsset=asset;
    showSingle();
    const boxes=document.querySelectorAll(".asset-box");
    boxes.forEach(box=>{
        if(box.innerText===asset){
            box.classList.add("asset-selected");
        }
    });
}

function setStyle(s){
    if(s==="scalp") document.getElementById("durationValue").value=15;
    if(s==="intraday") document.getElementById("durationValue").value=240;
    if(s==="swing") document.getElementById("durationValue").value=1440;
}

async function generate(){
    const account=document.getElementById("account").value;
    const risk=document.getElementById("risk").value;

    let url=`/api/scan?account=${account}&risk=${risk}`;

    const res=await fetch(url);
    const data=await res.json();

    const container=document.getElementById("output");
    container.innerHTML="";

    if(data.results){
        data.results.forEach(t=>{
            container.innerHTML+=`
            <div class="card">
            <h3>${t.asset}</h3>
            <b>${t.direction}</b><br>
            Entry: ${t.entry}<br>
            TP: ${t.tp}<br>
            SL: ${t.sl}<br>
            Size: ${t.size}
            </div>`;
        });
    }else{
        container.innerHTML="<div class='card'>No Trades</div>";
    }
}

async function loadHeatmap(){
    const res=await fetch('/api/heatmap');
    const data=await res.json();
    const container=document.getElementById("output");
    container.innerHTML="";

    data.heatmap.forEach(h=>{
        let cls="heat-neutral";
        if(h.status==="BULLISH") cls="heat-bull";
        if(h.status==="BEARISH") cls="heat-bear";

        container.innerHTML+=`
        <div class="card ${cls}">
        ${h.asset}<br>${h.status}
        </div>`;
    });
}

async function loadAnalytics(){
    const res=await fetch('/api/analytics');
    const data=await res.json();

    document.getElementById("dashboard").innerHTML=`
    <div class="card">
    Winrate: ${data.winrate}%<br>
    Expectancy: ${data.expectancy}<br>
    Avg RR: ${data.avg_rr}<br>
    Edge Score: ${data.edge_score}%<br>
    Grade: ${data.edge_grade}
    </div>`;
}

</script>

</body>
</html>
