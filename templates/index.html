<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Quant Pro Trading Engine</title>

<style>
body{
    margin:0;
    font-family:Arial, sans-serif;
    background:#0b1220;
    color:white;
}

header{
    background:#111827;
    padding:20px;
    text-align:center;
    font-size:22px;
    font-weight:bold;
}

.controls{
    display:flex;
    flex-wrap:wrap;
    gap:10px;
    justify-content:center;
    padding:20px;
}

button, select, input{
    padding:10px 14px;
    border-radius:8px;
    border:none;
    font-size:14px;
}

button{
    background:#16a34a;
    color:white;
    cursor:pointer;
}

button:hover{
    background:#15803d;
}

.mode-btn{
    background:#1f2937;
}

.mode-btn.active{
    background:#2563eb;
}

.grid{
    display:grid;
    grid-template-columns:repeat(auto-fit,minmax(300px,1fr));
    gap:20px;
    padding:20px;
}

.card{
    background:#111827;
    padding:20px;
    border-radius:14px;
    border:1px solid #1f2937;
}

.asset{
    font-size:18px;
    font-weight:bold;
    margin-bottom:10px;
}

.buy{color:#22c55e;}
.sell{color:#ef4444;}

.meta{
    font-size:13px;
    opacity:0.8;
    margin-top:10px;
}

.loading{
    text-align:center;
    padding:40px;
}
</style>
</head>

<body>

<header>Quant Pro Trading Engine</header>

<div class="controls">

<select id="market">
<option value="crypto">Crypto</option>
</select>

<button class="mode-btn active" onclick="setMode('scalp', this)">Scalp</button>
<button class="mode-btn" onclick="setMode('intraday', this)">Intraday</button>
<button class="mode-btn" onclick="setMode('swing', this)">Swing</button>

<input type="number" id="customMinutes" placeholder="Custom Minutes" min="1" style="width:140px;">

<button onclick="generate()">Generate Trades</button>

</div>

<div id="results" class="grid"></div>

<script>

let tradeType = "scalp";

function setMode(mode, element){
    tradeType = mode;
    document.querySelectorAll(".mode-btn").forEach(btn=>btn.classList.remove("active"));
    element.classList.add("active");
}

async function generate(){

    const market = document.getElementById("market").value;
    const customMinutes = document.getElementById("customMinutes").value || 15;
    const container = document.getElementById("results");

    container.innerHTML = "<div class='loading'>Running Quant Analysis...</div>";

    try{
        const res = await fetch(`/api/scan?market=${market}&type=${tradeType}&minutes=${customMinutes}`);
        const data = await res.json();

        if(!data.results || data.results.length === 0){
            container.innerHTML = "<div class='loading'>No high probability trades found.</div>";
            return;
        }

        let html = "";

        data.results.forEach(t=>{

            let dirClass = t.direction === "BUY" ? "buy" : "sell";

            html += `
            <div class="card">
                <div class="asset">${t.asset}</div>
                Direction: <span class="${dirClass}">${t.direction}</span><br>
                Entry: ${t.entry}<br>
                Take Profit: ${t.take_profit}<br>
                Stop Loss: ${t.stop_loss}<br>
                Leverage: ${t.leverage}x<br>
                Timeframe Used: ${t.interval}<br>
                <div class="meta">
                    Score: ${t.score} / 7<br>
                    Logic: ${t.logic}
                </div>
            </div>
            `;
        });

        container.innerHTML = html;

    }catch(e){
        container.innerHTML = "<div class='loading'>Error loading analysis.</div>";
    }
}

</script>

</body>
</html>
